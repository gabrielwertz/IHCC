MAIN 
	CALL INIT 
	WHILE MORE-RECS = "YES"
	
	CALL MAINLINE
	CALL CLOSING	
init
	open input file
	open output file
	request date
	get DATE
	O-DATE TO DATE
	CALL READ
	CALL HDGS 
	H-BOAT-TYPE =  I-BOAT-TYPE
MAIN LINE 
	IF H-BOAT-TYPE != I-BOAT-TYPE
		CALL MJBREAK
	CALL CALCS
	CALL OUTPUT
	CALL READ
CALC
	C-BOAT-COST = PREP-DELIVER-COST + I-BOAT-COST
	TOTAL += MJ-TOTAL-COST
	BOAT-CTR += 1
OUTPUT
	O-LNAME = I-LNAME
	O-STATE = I-STATE
	O-BOAT-CST = I-BOAT-COST
	O-PURCHASE-DATE = I-PURCHASE-DATE
	O-TOTAL = TOTAL 
	I-ACCESSORY-PACKAGE
		WHEN 1
			ACCESSORY-PACKAGE = 'ELECTRONICS'
		WHEN 2
			ACCESSORY-PACKAGE = 'SKI PACKAGE'
		WHEN 3
			ACCESSORY-PACKAGE = 'FISHING PACKAGE'
	ACCESSORY-PACKAGE = I-ACCESSORY-PACKAGE
	
	PRINT DETAIL LINE
		IF EOP CALL HDGS 
CLOSING
	CALL MJBREAK
	CALL GRANDTOTALS
	CLOSE INPUT FILE
	CLOSE OUTPUT FILE
GRANDTOTALS
	O-GT-BOAT-CTR = GT-BOAT-CTR
	O-GT-TOTAL-COST = GT-TOTAL
	PRINT BLANK LINE
	PRINT BLANK LINE
	PRINT GRANDTOTALS LINE
MJBREAK
	O-BOAT-CTR = BOAT-CTR
	O-MJ-TOTAL-COST = MJ-TOTAL-COST
	PRINT BLANK LINE
	PRINT MJBREAK LINE
	PRINT BLANK LINE
	I-BOAT-TYPE
		WHEN B
			O-BOAT-TYPE = 'BASS BOAT'
		WHEN P
			O-BOAT-TYPE = 'PONTOON BOAT'
		WHEN S 
			O-BOAT-TYPE = 'SKI BOAT'
		WHEN J
			O-BOAT-TYPE = 'JOHN BOAT'
		WHEN C
			O-BOAT-TYPE = 'CANOE'
		WHEN R
			O-BOAT-TYPE = 'CABIN CRUISER'
	PRINT BOAT-TYPE LINE
	PRINT BLANK LINE
	
	GT-BOAT-CTR += BOAT-CTR
	GT-TOTAL-COST += TOTAL-COST
	H-BOAT-TYPE = I-BOAT-TYPE
	BOAT-CTR = 0
	MJ-TOTAL-COST = 0
READ 
	READ RECORD
		IF EOF MORE-RECS = 'YES'
		
HDGS 

		PCTR += 1
		O-PCTR = PCTR
	PRINT COMPANY TITLE LINE
	PRINT BLANK LINE
	PRINT COL HDG 1
	PRINT COL HDG 2
	PRINT BLANK LINE
	PRINT BOAT TYPE LINE
	PRINT BLANK LINE
	